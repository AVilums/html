<!DOCTYPE html>
<html>

<head>
    <script type="text/javascript" src="csv.js"></script>
    <script type="text/javascript" src="file.js"></script>
    
    <h1>Izvēlēties darba failus:</h1>
    
    <form id="myForm">
        <label for="csvFile">Pievienojiet <b>personals.csv</b> failu</label>
        <input type="file" id="csvFile" accept=".csv" multiple/>
        <br />
    </form>

    <h1>Personāla izvade pēc:</h1>
    
    <script>
        var personalsViss;

        const struktura = []; // piesardzīgi ar šiem nosaukiem, jo compare funkcijas izmanto
        const strukturaId = []; // abus mainīgos, kā fiksētus 

        document.getElementById("csvFile").addEventListener("change", function(ev) {
        let files = ev.currentTarget.files;
        let readers = [];

        if(!files.length) return;                               // Abort if there were no files selected
                                                                
        for(let i = 0;i < files.length;i++) {                   // Store promises in array
            readers.push(readFileAsText(files[i]));
        }
                
        Promise.all(readers).then((values) => {                     // Trigger Promises
            checkFileAmount(values, 1);                             // file.js
            let viens = stringTo2dArray(values[0],"!", ",");
            compareToPersonals(viens);                              // file.js
        });
    }, false);

        function submitOnClick() {
            let choice = document.getElementById("izvadit").value;
            
            alert(personalsViss[2][0]); // ID
            
            const tempArr = [[],[]];
            let x = 0;

            for (let i = 1; i < personalsViss.length; i++) {
                alert("HERE1");
                for (let j = 0; j < personalsViss.length; j++) {
                    alert("HERE2");
                    tempArr[x][0] = personalsViss[i][0];    
                    alert(tempArr[x][0]);
                }
                x++;
            }

            // arrayToHTML()
            
            // If choice = strukturvieniba Then
            // Grāds | Vārds | Uzvārds | Struktūrvienība(1-3) | Amats(1-3) | Kontaktinformācija

            // Else if choice = uzvards Then 
            // Grāds | Vārds | Uzvārds | Amats(1-3) | Kontaktinformācija

            alert(choice);
        }

    </script>

</head>

<body>
    <form>
        <select name="izvadit" id="izvadit" onchange="myFunction()">
            <option value="empty" selected></option>
            <option value="strukturvieniba">Struktūrvienības</option>
            <option value="uzvards">Personāla uzvārda</option>
        </select>
        <button onclick="submitOnClick()">Izvadīt</button>
    </form>
</body>

</html>